import{r as h,k as A,o as S,j as e,s as M,t as k,v as P,N as B,S as D,B as f,i as T,H as F,I as G,J as R,K as H}from"./index-C4RmwaTK.js";import{F as l}from"./Form-DKdaOfKv.js";import{M as v}from"./Modal-Bauv4i2O.js";import"./Col-CN402Iio.js";const L=h.forwardRef(({bsPrefix:w,className:j,striped:i,bordered:y,borderless:d,hover:x,size:t,variant:p,responsive:c,...u},b)=>{const n=A(w,"table"),g=S(j,n,p&&`${n}-${p}`,t&&`${n}-${t}`,i&&`${n}-${typeof i=="string"?`striped-${i}`:"striped"}`,y&&`${n}-bordered`,d&&`${n}-borderless`,x&&`${n}-hover`),m=e.jsx("table",{...u,className:g,ref:b});if(c){let C=`${n}-responsive`;return typeof c=="string"&&(C=`${C}-${c}`),e.jsx("div",{className:C,children:m})}return m}),q=()=>{const[w,j]=h.useState(!1),[i,y]=h.useState(!1),[d,x]=h.useState([]),[t,p]=h.useState(null),[c,u]=h.useState({name:"",description:"",active:1}),b=M(s=>s.user.rol);h.useEffect(()=>{async function s(){const r=await T(0);r&&x(r.categories)}s()},[]);const n=()=>{u({name:"",description:"",active:1}),y(!1),j(!0)},g=()=>j(!1),m=s=>{const{name:r,value:a}=s.target;i&&t?p(o=>o&&{...o,[r]:a}):u(o=>({...o,[r]:a}))},C=async()=>{try{const a={id:(d.length>0?d[d.length-1].id:0)+1,name:c.name,description:c.description,active:1};await F(a)==="categorie added successfully."&&(x(I=>[...I,a]),u({name:"",description:"",active:1}),g())}catch(s){console.error("Error al agregar la categoría:",s)}},N=async(s,r)=>{try{r===1?await G(s):await R(s),x(a=>a.map(o=>o.id===s?{...o,active:o.active===1?0:1}:o))}catch(a){console.error("Error al cambiar el estado de la categoría:",a)}},E=s=>{const r=d.find(a=>a.id===s);r&&(p(r),y(!0),j(!0))},$=async()=>{if(t)try{await H(t)==="Categorie updated successfully."&&(x(r=>r.map(a=>a.id===t.id?{...a,...t}:a)),g())}catch(s){console.error("Error al actualizar la categoría:",s)}};return b!==k.ADMIN?e.jsx(P,{replace:!0,to:"../"}):e.jsxs(e.Fragment,{children:[e.jsx(B,{}),e.jsxs("div",{className:"d-flex",children:[e.jsx(D,{userRole:b}),e.jsxs("div",{className:"container",children:[e.jsx("h2",{children:"Categorías"}),e.jsx(f,{variant:"primary",onClick:n,children:"Agregar Categoría"}),e.jsxs(L,{striped:!0,bordered:!0,hover:!0,className:"mt-4",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"ID"}),e.jsx("th",{children:"Nombre"}),e.jsx("th",{children:"Descripción"}),e.jsx("th",{children:"Estado"}),e.jsx("th",{children:"Acciones"})]})}),e.jsx("tbody",{children:d.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.id}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.description}),e.jsx("td",{children:e.jsx(l.Check,{type:"switch",checked:s.active===1,onChange:()=>N(s.id,s.active),label:(s.active===1,"")})}),e.jsx("td",{children:e.jsx(f,{variant:"warning",onClick:()=>E(s.id),children:"Editar"})})]},s.id))})]}),e.jsxs(v,{show:w,onHide:g,children:[e.jsx(v.Header,{closeButton:!0,children:e.jsx(v.Title,{children:i?"Editar Categoría":"Agregar Categoría"})}),e.jsx(v.Body,{children:e.jsxs(l,{children:[e.jsxs(l.Group,{controlId:"categoryName",children:[e.jsx(l.Label,{children:"Nombre"}),e.jsx(l.Control,{type:"text",name:"name",value:i&&t?t.name:c.name,onChange:m,placeholder:"Ingrese el nombre de la categoría"})]}),e.jsxs(l.Group,{controlId:"categoryDescription",className:"mt-3",children:[e.jsx(l.Label,{children:"Descripción"}),e.jsx(l.Control,{as:"textarea",name:"description",value:i&&t?t.description:c.description,onChange:m,placeholder:"Ingrese la descripción"})]})]})}),e.jsxs(v.Footer,{children:[e.jsx(f,{variant:"secondary",onClick:g,children:"Cancelar"}),i?e.jsx(f,{variant:"primary",onClick:$,children:"Actualizar"}):e.jsx(f,{variant:"primary",onClick:C,children:"Agregar"})]})]})]})]})]})};export{q as default};
